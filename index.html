<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#1E40AF" />
    <!-- ✅ 修复：使用带子路径的绝对路径 -->
    <link rel="manifest" href="/anomaly-pwa/manifest.json" />
    <title>异常提报系统</title>

    <!-- Paho MQTT Client (CDN 不受影响) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
    <script type="module" crossorigin src="/anomaly-pwa/assets/main-BN5yU7IN.js"></script>
    <link rel="stylesheet" crossorigin href="/anomaly-pwa/assets/main-B54GpxHq.css">
  </head>
  <body class="bg-gray-100 font-sans">
    <div id="app" class="min-h-screen bg-gray-50">
      <div class="flex items-center justify-center h-screen text-gray-500">
        加载中...
      </div>
    </div>

    <nav id="bottom-nav" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around py-3 px-6 max-w-md mx-auto w-full">
      <a href="#/" class="text-center text-gray-600 hover:text-primary">
        <div class="text-xs">首页</div>
      </a>
      <a href="#/qr-gen" class="text-center text-gray-600 hover:text-primary">
        <div class="text-xs">生成二维码</div>
      </a>
      <a href="#/mqtt-config" class="text-center text-gray-600 hover:text-primary">
        <div class="text-xs">MQTT配置</div>
      </a>
    </nav>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // ✅ 修复：使用带子路径的绝对路径
          navigator.serviceWorker.register('/anomaly-pwa/service-worker.js')
            .then(reg => console.log('✅ SW registered:', reg.scope))
            .catch(err => console.warn('⚠️ SW registration failed:', err));
        });
      }
    </script>
  </body>
</html>