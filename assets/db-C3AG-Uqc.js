const c="AbnormalReportDB",a=async()=>new Promise((n,e)=>{const t=indexedDB.open(c,1);t.onerror=()=>e(t.error),t.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains("drafts")||o.createObjectStore("drafts",{keyPath:"id"}),o.objectStoreNames.contains("config")||o.createObjectStore("config",{keyPath:"key"})},t.onsuccess=()=>n(t.result)}),s=async n=>{const t=(await a()).transaction("drafts","readwrite");n.id="current",n.timestamp=new Date().toISOString(),t.objectStore("drafts").put(n),await t.done},i=async()=>{const e=(await a()).transaction("drafts","readonly"),t=await e.objectStore("drafts").get("current");return await e.done,t},d=async()=>{const e=(await a()).transaction("drafts","readwrite");e.objectStore("drafts").delete("current"),await e.done},b=async n=>{const t=(await a()).transaction("config","readwrite");await t.objectStore("config").put({key:"mqtt",...n}),await t.done},f=async()=>{const e=(await a()).transaction("config","readonly"),t=await e.objectStore("config").get("mqtt");return await e.done,t};export{d as deleteDraft,f as getConfig,i as getDraft,a as openDB,b as saveConfig,s as saveDraft};
//# sourceMappingURL=db-C3AG-Uqc.js.map
