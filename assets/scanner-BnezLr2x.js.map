{"version":3,"file":"scanner-BnezLr2x.js","sources":["../../scanner.js"],"sourcesContent":["let codeReader = null;\r\n\r\nexport const startScan = async (onResult) => {\r\n  const container = document.getElementById('scanner-container');\r\n  const video = document.getElementById('qr-video');\r\n  const closeBtn = document.getElementById('close-scanner');\r\n\r\n  container.classList.remove('hidden');\r\n  \r\n  codeReader = new ZXing.BrowserQRCodeReader();\r\n  \r\n  closeBtn.onclick = () => {\r\n    codeReader.reset();\r\n    container.classList.add('hidden');\r\n  };\r\n\r\n  try {\r\n    await codeReader.decodeFromVideoDevice(undefined, video, (result, err) => {\r\n      if (result) {\r\n        codeReader.reset();\r\n        container.classList.add('hidden');\r\n        onResult(result.getText());\r\n      }\r\n    });\r\n  } catch (err) {\r\n    alert('请允许摄像头权限以扫描二维码\\n\\n【重试】');\r\n    container.classList.add('hidden');\r\n  }\r\n};\r\n\r\n// Load ZXing\r\nconst script = document.createElement('script');\r\nscript.src = 'https://cdn.jsdelivr.net/npm/@zxing/library@0.18.3/umd/index.min.js';\r\nscript.onload = () => {\r\n  window.ZXing = ZXing;\r\n};\r\ndocument.head.appendChild(script);"],"names":["codeReader","startScan","onResult","container","video","closeBtn","result","err","script"],"mappings":"AAAA,IAAIA,EAAa,KAEL,MAACC,EAAY,MAAOC,GAAa,CAC3C,MAAMC,EAAY,SAAS,eAAe,mBAAmB,EACvDC,EAAQ,SAAS,eAAe,UAAU,EAC1CC,EAAW,SAAS,eAAe,eAAe,EAExDF,EAAU,UAAU,OAAO,QAAQ,EAEnCH,EAAa,IAAI,MAAM,oBAEvBK,EAAS,QAAU,IAAM,CACvBL,EAAW,MAAK,EAChBG,EAAU,UAAU,IAAI,QAAQ,CAClC,EAEA,GAAI,CACF,MAAMH,EAAW,sBAAsB,OAAWI,EAAO,CAACE,EAAQC,IAAQ,CACpED,IACFN,EAAW,MAAK,EAChBG,EAAU,UAAU,IAAI,QAAQ,EAChCD,EAASI,EAAO,QAAO,CAAE,EAE7B,CAAC,CACH,MAAc,CACZ,MAAM;AAAA;AAAA,KAAwB,EAC9BH,EAAU,UAAU,IAAI,QAAQ,CAClC,CACF,EAGMK,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,IAAM,sEACbA,EAAO,OAAS,IAAM,CACpB,OAAO,MAAQ,KACjB,EACA,SAAS,KAAK,YAAYA,CAAM"}